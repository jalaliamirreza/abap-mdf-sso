# مشخصات فرمت دیسکت بیمه تامین اجتماعی
# Iranian Social Security (SSO) Insurance Diskette Format Specification

## نمای کلی / Overview

این سند مشخصات فایل DBF (dBase) مورد نیاز سازمان تامین اجتماعی ایران را برای ارسال لیست ماهانه بیمه شرح می‌دهد.

This document describes the DBF (dBase) file format required by the Iranian Social Security Organization for monthly insurance list submissions.

## مشخصات فایل / File Specifications

- **نوع فایل / File Type**: dBase III/IV (.dbf)
- **کدگذاری / Character Encoding**: Windows-1256 (CP1256) - Persian/Arabic
- **ترمینیشن خط / Line Termination**: CR+LF (0x0D 0x0A)
- **نام فایل / Filename Convention**: `MADRAK_YYYYMM.DBF` (مثال: MADRAK_140212.DBF)

## ساختار فیلدها / Field Structure

### جدول فیلدها / Field Table

| شماره | نام فیلد | Field Name (English) | نوع | طول | اعشار | الزامی | توضیحات |
|------|---------|---------------------|------|-----|-------|--------|---------|
| 1 | SHOMARE_B | Insurance Number | C | 20 | - | بله | شماره بیمه پرسنل |
| 2 | KOD_MELI | National ID | C | 10 | - | بله | کد ملی 10 رقمی |
| 3 | NAM | First Name | C | 30 | - | بله | نام |
| 4 | NAM_KHANE | Last Name | C | 40 | - | بله | نام خانوادگی |
| 5 | NAM_PEDAR | Father's Name | C | 30 | - | بله | نام پدر |
| 6 | TARIKH_TAV | Birth Date | C | 8 | - | بله | تاریخ تولد (شمسی) YYYYMMDD |
| 7 | ROOZ_KAR | Working Days | N | 3 | 0 | بله | تعداد روزهای کارکرد |
| 8 | HOGHOGH | Base Salary | N | 15 | 0 | بله | حقوق مبنا (ریال) |
| 9 | EZAFE_KAR | Overtime | N | 15 | 0 | خیر | اضافه کاری (ریال) |
| 10 | MAZAYA | Benefits | N | 15 | 0 | خیر | مزایای مشمول (ریال) |
| 11 | JAM_MAZAYA | Total Benefits | N | 15 | 0 | بله | جمع کل مزایا (ریال) |
| 12 | TAR_SHOROO | Start Date | C | 8 | - | خیر | تاریخ شروع به کار (شمسی) |
| 13 | TAR_KHATEME | End Date | C | 8 | - | خیر | تاریخ خاتمه کار (شمسی) |
| 14 | NOE_GHARA | Contract Type | C | 2 | - | بله | نوع قرارداد |
| 15 | SABEGHE | Work History | N | 5 | 2 | خیر | سابقه کار (سال) |

### توضیحات تفصیلی فیلدها / Detailed Field Descriptions

#### 1. SHOMARE_B (شماره بیمه)
- **طول**: 20 کاراکتر
- **فرمت**: عددی با پیش‌صفرها
- **مثال**: `00001234567890123456`
- **اعتبارسنجی**: باید عدد باشد و طول آن 20 رقم باشد

#### 2. KOD_MELI (کد ملی)
- **طول**: 10 کاراکتر
- **فرمت**: عددی 10 رقمی
- **مثال**: `1234567890`
- **اعتبارسنجی**: باید کد ملی معتبر باشد (الگوریتم چک‌سام)

#### 3. NAM (نام)
- **طول**: 30 کاراکتر
- **فرمت**: فارسی
- **مثال**: `علی`
- **نکته**: از Windows-1256 برای کدگذاری استفاده شود

#### 4. NAM_KHANE (نام خانوادگی)
- **طول**: 40 کاراکتر
- **فرمت**: فارسی
- **مثال**: `احمدی`

#### 5. NAM_PEDAR (نام پدر)
- **طول**: 30 کاراکتر
- **فرمت**: فارسی
- **مثال**: `حسین`

#### 6. TARIKH_TAV (تاریخ تولد)
- **طول**: 8 کاراکتر
- **فرمت**: YYYYMMDD (شمسی)
- **مثال**: `13650523` (23 خرداد 1365)
- **اعتبارسنجی**: تاریخ باید معتبر باشد

#### 7. ROOZ_KAR (روزهای کارکرد)
- **طول**: 3 رقم
- **فرمت**: عدد صحیح
- **مثال**: `030` (30 روز)
- **محدوده**: 1 تا 31

#### 8. HOGHOGH (حقوق مبنا)
- **طول**: 15 رقم
- **فرمت**: عدد صحیح (ریال)
- **مثال**: `000050000000` (50 میلیون ریال)
- **نکته**: بدون جداکننده هزارگان

#### 9. EZAFE_KAR (اضافه کار)
- **طول**: 15 رقم
- **فرمت**: عدد صحیح (ریال)
- **مثال**: `000005000000` (5 میلیون ریال)

#### 10. MAZAYA (مزایا)
- **طول**: 15 رقم
- **فرمت**: عدد صحیح (ریال)
- **مثال**: `000010000000` (10 میلیون ریال)
- **شامل**: مزایای مشمول بیمه

#### 11. JAM_MAZAYA (جمع مزایا)
- **طول**: 15 رقم
- **فرمت**: عدد صحیح (ریال)
- **مثال**: `000065000000` (65 میلیون ریال)
- **محاسبه**: HOGHOGH + EZAFE_KAR + MAZAYA

#### 12. TAR_SHOROO (تاریخ شروع)
- **طول**: 8 کاراکتر
- **فرمت**: YYYYMMDD (شمسی)
- **مثال**: `14020101` (1 فروردین 1402)

#### 13. TAR_KHATEME (تاریخ خاتمه)
- **طول**: 8 کاراکتر
- **فرمت**: YYYYMMDD (شمسی)
- **مثال**: `14021231` (31 اسفند 1402)
- **نکته**: برای کارمندان فعال خالی باشد

#### 14. NOE_GHARA (نوع قرارداد)
- **طول**: 2 کاراکتر
- **فرمت**: کد
- **مقادیر مجاز**:
  - `01`: رسمی - قطعی
  - `02`: رسمی - آزمایشی
  - `03`: پیمانی
  - `04`: قراردادی
  - `05`: روزمزد
  - `06`: ساعتی

#### 15. SABEGHE (سابقه کار)
- **طول**: 5 رقم (3 صحیح + 2 اعشار)
- **فرمت**: عدد اعشاری
- **مثال**: `005.50` (5 سال و 6 ماه)

## نمونه رکورد / Sample Record

```
SHOMARE_B          : 00001234567890123456
KOD_MELI           : 1234567890
NAM                : علی
NAM_KHANE          : احمدی
NAM_PEDAR          : حسین
TARIKH_TAV         : 13650523
ROOZ_KAR           : 030
HOGHOGH            : 000050000000000
EZAFE_KAR          : 000005000000000
MAZAYA             : 000010000000000
JAM_MAZAYA         : 000065000000000
TAR_SHOROO         : 14020101
TAR_KHATEME        : 14021231
NOE_GHARA          : 01
SABEGHE            : 05.50
```

## قوانین اعتبارسنجی / Validation Rules

### 1. اعتبارسنجی کد ملی / National ID Validation

کد ملی باید:
- 10 رقم باشد
- الگوریتم چک‌سام را بگذراند
- تمام ارقام یکسان نباشد (مثلاً 1111111111)

```python
def validate_national_id(national_id):
    if len(national_id) != 10:
        return False
    if national_id == national_id[0] * 10:
        return False

    check_sum = 0
    for i in range(9):
        check_sum += int(national_id[i]) * (10 - i)

    remainder = check_sum % 11
    check_digit = int(national_id[9])

    if remainder < 2:
        return check_digit == remainder
    else:
        return check_digit == (11 - remainder)
```

### 2. اعتبارسنجی تاریخ / Date Validation

تاریخ‌های شمسی باید:
- فرمت YYYYMMDD داشته باشند
- سال بین 1300 تا 1500 باشد
- ماه بین 01 تا 12 باشد
- روز بر اساس ماه معتبر باشد:
  - ماه‌های 1-6: 1-31
  - ماه‌های 7-11: 1-30
  - ماه 12: 1-29 (سال عادی) یا 1-30 (سال کبیسه)

### 3. اعتبارسنجی مبالغ / Amount Validation

- تمام مبالغ باید >= 0 باشند
- JAM_MAZAYA = HOGHOGH + EZAFE_KAR + MAZAYA
- حداکثر مبلغ: 999,999,999,999,999 ریال

### 4. اعتبارسنجی روزهای کارکرد / Working Days Validation

- باید بین 1 تا 31 باشد
- نباید بیشتر از تعداد روزهای ماه باشد
- برای ماه‌های ناقص باید متناسب باشد

## کدگذاری کاراکترها / Character Encoding

### Windows-1256 Mapping for Persian

فایل DBF باید با کدگذاری Windows-1256 ذخیره شود تا کاراکترهای فارسی به درستی نمایش داده شوند.

**حروف فارسی رایج**:
- ا: 0xC7
- ب: 0xC8
- پ: 0xCC
- ت: 0xCA
- ث: 0xCB
- ج: 0xCC
- ... (و سایر حروف)

## نکات مهم / Important Notes

1. **ترتیب رکوردها**: رکوردها می‌توانند به هر ترتیبی باشند
2. **رکوردهای خالی**: رکوردهایی با فیلدهای خالی قابل قبول نیستند
3. **فضای خالی**: فیلدهای متنی باید با space پر شوند (راست‌چین برای فارسی)
4. **پیش‌صفر**: فیلدهای عددی باید با صفر پر شوند
5. **حساسیت به بزرگی حروف**: نام فیلدها باید UPPERCASE باشند

## فرآیند آپلود / Upload Process

1. فایل DBF را با نام `MADRAK_YYYYMM.DBF` ایجاد کنید
2. وارد سایت تامین اجتماعی شوید: https://www.tamin.ir
3. بخش "کارفرمایان" > "لیست ماهانه بیمه"
4. فایل را آپلود کنید
5. خطاها را بررسی و رفع کنید
6. ارسال نهایی

## منابع / References

- سایت تامین اجتماعی: https://www.tamin.ir
- راهنمای کاربری سیستم کارفرمایان
- فرمت استاندارد dBase III/IV

## تاریخچه تغییرات / Change History

| نسخه | تاریخ | تغییرات |
|------|-------|---------|
| 1.0 | 1402/09/01 | نسخه اولیه |
| 1.1 | 1402/11/15 | اضافه شدن فیلد NOE_GHARA |
| 1.2 | 1403/01/01 | اصلاح فرمت SABEGHE |

---

**توجه**: این مشخصات بر اساس آخرین الزامات سازمان تامین اجتماعی تهیه شده است. لطفاً قبل از استفاده، آخرین نسخه را از سایت رسمی دریافت کنید.
