# راهنمای استفاده از رابط گرافیکی (GUI)

**نسخه:** 2.0 - با پشتیبانی SSO 2024

---

## 🚀 اجرا

```bash
python tools/dbf_converter_gui.py
```

یا اگر مستقیماً از پوشه tools اجرا می‌کنید:

```bash
cd tools
python dbf_converter_gui.py
```

---

## 📋 ویژگی‌های GUI

### ✅ نسخه جدید (2.0):
- **ساختار SSO 2024** (25 فیلد header، 29 فیلد workers)
- **Iran System Encoding** خودکار
- **دیکد خودکار** متن فارسی
- نمایش پیشرفت در real-time
- نمایش Hex برای debugging

---

## 📖 نحوه استفاده

### تب 1: CSV → DBF (تبدیل به فرمت SSO)

#### گام 1: انتخاب فایل‌های ورودی
- **فایل Header:** `header.csv` - اطلاعات کارگاه (1 سطر)
- **فایل Workers:** `workers.csv` - لیست کارگران (N سطر)

#### گام 2: وارد کردن پارامترها
- **کد کارگاه:** 10 رقمی (مثال: `9018282956`)
- **سال:** 2 رقمی (مثال: `4` برای 1404)
- **ماه:** 1-12 (مثال: `7` برای تیر)
- **پوشه خروجی:** مسیر (پیش‌فرض: `output`)

#### گام 3: تبدیل
دکمه **"تبدیل به DBF"** را بزنید.

#### خروجی:
```
output/
├── dskkar00.dbf  (فایل Header - آماده آپلود)
└── dskwor00.dbf  (فایل Workers - آماده آپلود)
```

---

### تب 2: DBF → CSV (بررسی فایل‌های SSO)

#### گام 1: انتخاب فایل‌های DBF
- **dskkar00.dbf** - فایل header
- **dskwor00.dbf** - فایل workers

#### گام 2: گزینه‌ها
☑️ **نمایش Hex برای فیلدهای فارسی**
- توصیه می‌شود برای debugging
- نمایش کدهای Iran System در کنار متن فارسی

#### گام 3: تبدیل
دکمه **"تبدیل به CSV"** را بزنید.

#### خروجی:
```
output/
├── header.csv   (فایل Header قابل خواندن)
└── workers.csv  (فایل Workers با متن فارسی)
```

---

## 🎨 تصویر رابط

```
╔═══════════════════════════════════════════════════════════════╗
║  تبدیل‌کننده DBF - SSO 2024 (ساختار جدید)                  ║
╠═══════════════════════════════════════════════════════════════╣
║                                                               ║
║  [CSV → DBF]  [DBF → CSV]                                    ║
║                                                               ║
║  ┌─────────────────────────────────────────────────────────┐ ║
║  │  تبدیل CSV به DBF                                       │ ║
║  │  ✅ ساختار جدید SSO 2024 (25 فیلد header، 29 فیلد    │ ║
║  │                                        workers)          │ ║
║  ├─────────────────────────────────────────────────────────┤ ║
║  │  فایل‌های ورودی (CSV)                                  │ ║
║  │  ┌──────────────────────────────────────┐               │ ║
║  │  │ فایل Header: [________________] [...]│               │ ║
║  │  │ فایل Workers: [_______________] [...]│               │ ║
║  │  └──────────────────────────────────────┘               │ ║
║  │                                                          │ ║
║  │  پارامترها                                              │ ║
║  │  ┌──────────────────────────────────────┐               │ ║
║  │  │ کد کارگاه: [__________]             │               │ ║
║  │  │ سال:        [__]                     │               │ ║
║  │  │ ماه:        [__]                     │               │ ║
║  │  │ پوشه خروجی: [__________] [...]      │               │ ║
║  │  └──────────────────────────────────────┘               │ ║
║  │                                                          │ ║
║  │            [  تبدیل به DBF  ]                           │ ║
║  │                                                          │ ║
║  │  ┌────────────────── لاگ ─────────────────┐             │ ║
║  │  │ Reading CSV files...                   │             │ ║
║  │  │ ✅ Loaded header + 3 workers           │             │ ║
║  │  │ Creating Header File...                │             │ ║
║  │  │ ✅ Complete!                            │             │ ║
║  │  └────────────────────────────────────────┘             │ ║
║  └─────────────────────────────────────────────────────────┘ ║
║                                                               ║
╚═══════════════════════════════════════════════════════════════╝
```

---

## ⚙️ الزامات سیستمی

- **Python:** 3.8 یا بالاتر
- **tkinter:** پیش‌فرض نصب شده (با Python)
- **وابستگی‌ها:** (از requirements.txt نصب شوند)
  ```bash
  pip install -r requirements.txt
  ```

---

## 🐛 عیب‌یابی

### GUI باز نمی‌شود
```bash
# چک کنید tkinter نصب باشد:
python -m tkinter
```

اگر پنجره کوچکی باز شد، tkinter نصب است ✅

### خطای "Module not found"
```bash
# نصب وابستگی‌ها:
pip install -r requirements.txt
```

### فونت فارسی درست نمایش نمی‌دهد
فونت `Tahoma` یا `Arial` باید روی سیستم نصب باشد.

---

## 💡 نکات کاربردی

### 1. Drag & Drop (در آینده)
در نسخه‌های بعدی قابلیت کشیدن و رها کردن فایل‌ها اضافه می‌شود.

### 2. نمایش Hex
برای بررسی دقیق encoding فارسی، گزینه **"نمایش Hex"** را فعال کنید:
```csv
DSW_FNAME,DSW_FNAME_HEX
علی,fce4fc
```

### 3. تبدیل دسته‌ای (Batch)
برای تبدیل چند فایل، می‌توانید GUI را چند بار اجرا کنید یا از CLI استفاده کنید:
```bash
for file in *.csv; do
    python tools/csv_to_dbf_complete.py ...
done
```

---

## 📊 مقایسه CLI vs GUI

| ویژگی | CLI | GUI |
|-------|-----|-----|
| سرعت | ⚡ سریع‌تر | 🐌 کمی کندتر |
| راحتی | 🔧 نیاز به دستور | 🖱️ کلیک ساده |
| Automation | ✅ آسان | ❌ دشوار |
| Debugging | 📜 لاگ کامل | 🔍 نمایش بصری |
| توصیه | Script & Automation | استفاده عادی |

---

## 🎯 مثال کامل

### سناریو: تبدیل لیست حقوق تیر ماه

#### 1. آماده‌سازی CSV

**header.csv:**
```csv
DSK_ID,DSK_NAME,DSK_FARM,DSK_ADRS,DSK_DISC
9018282956,کارگاه نمونه,مدیر کارگاه,تهران ولیعصر,لیست تیر
```

**workers.csv:**
```csv
DSW_ID1,DSW_FNAME,DSW_LNAME,...
12345678,علی,محمدی,...
23456789,فاطمه,احمدی,...
```

#### 2. اجرای GUI
```bash
python tools/dbf_converter_gui.py
```

#### 3. تنظیمات
- انتخاب فایل‌ها: `header.csv`, `workers.csv`
- کد کارگاه: `9018282956`
- سال: `4`
- ماه: `7`

#### 4. تبدیل
کلیک روی **"تبدیل به DBF"**

#### 5. نتیجه
```
✅ فایل‌های DBF با موفقیت در output ایجاد شدند!
```

#### 6. آپلود به SSO
دو فایل `dskkar00.dbf` و `dskwor00.dbf` را به سایت تامین اجتماعی آپلود کنید.

---

## 🔗 لینک‌های مفید

- **مستندات CLI:** `docs/USAGE.md`
- **ساختار SSO 2024:** `docs/NEW_STRUCTURE_2024.md`
- **راهنمای نصب:** `docs/INSTALLATION.md`
- **نمونه‌های واقعی:** `sample_output/README.md`

---

## 📞 پشتیبانی

برای گزارش مشکل یا پیشنهاد بهبود:
- ایجاد Issue در GitHub
- بررسی مستندات در پوشه `docs/`

---

**نسخه:** 2.0
**تاریخ:** 1403/09/02
**وضعیت:** ✅ تست شده با ساختار SSO 2024
